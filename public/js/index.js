populateGrid();

/**
 * Populates the boggle grid.
 * @return {[null]}
 */
function populateGrid(){
	const letters = getRandLetters(16, 2);
	// const solutionSet = getSolutionSet(letters);
	const solutionSet = checkWord(letters);
	console.log(letters);
	letters.forEach(function(letter, index){
		// console.log(index+". "+letter);
		var clas = "td.c-"+(index+1);
		// console.log(clas);
		$(clas).append("<p>"+letter.toUpperCase()+"</p>");
	})
}

/**
 * generate random letters assignment of provided length 
 * @length : {[type]} length of expected array
 * @maxDuplicate : {[type]} maximum amount of acceptable duplicate
 * @return {[array]} array containing random letters of provided length
 */
function getRandLetters(length, maxDuplicate){
	const alphaSet = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"];
	var randSet = [];
	while(randSet.length < length) {
		var rand = alphaSet[Math.floor(Math.random() * alphaSet.length)];
		var duplicateCount = 0;
		
		randSet.forEach(function(item, index){
			if (item == rand) {
				duplicateCount++; 
			}
		})

		if (duplicateCount >= maxDuplicate) {
			console.log(`More than ${maxDuplicate} '${rand}' present. Reject...`);
			continue
		} else{
			randSet.push(rand);
		}
	}
	return randSet;
}

/**
 * Get solution set from the letters generated by getRandLetters function. Uses ajax request to get solution file.
 * @param  {array} letters random letters generated bt getRandLetters function.
 * @return {arr/bool}         return solution set if successful else bool 0
 */		
function getSolutionSet(letters){
	letters = JSON.stringify(letters);
	console.log(typeof(letters));

	$(document).ready(function(){
		$.ajax({
	        url: 'ajax',
	        type: "post",
	        data: {'letters':letters},
	        success: function (response) {
	        	console.log(response);
				return response;
	        },
	        error: function(jqXHR, textStatus, errorThrown) {
	           // console.log(textStatus, errorThrown);
	           return 0;
	        }
    	});	
	})
}


function checkWord(letters){
	letters = JSON.stringify(letters);
	$(document).ready(function(){
		$("#submitWord").click(function(){
			var word = $("#word").val();
			$.ajax({
		        url: 'validateWord',
		        type: "post",
		        data: {'letters':letters, 'word':word},
		        success: function (response) {
		        	console.log(response);
		        	console.log(word)
					return response;
		        },
		        error: function(jqXHR, textStatus, errorThrown) {
		           // console.log(textStatus, errorThrown);
		           return 0;
		        }
	    	});	

		})
	})
}
